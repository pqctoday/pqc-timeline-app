---
reference_id: RFC 9629
document_type: Protocol
document_status: Proposed Standard
date_published: 2024-08-01
date_updated: 2024-08-01
region: International
migration_urgency: High
local_file: public/library/RFC_9629.html
---

# Using Key Encapsulation Mechanism (KEM) Algorithms in CMS

## Authors

**Organization:** IETF LAMPS

## Scope

**Industries:** IT; Email; Web PKI; Secure Messaging
**Region:** International
**Document type:** Protocol

## How It Relates to PQC

CMS encryption, S/MIME

**Dependencies:** RFC 5652; RFC 5280; FIPS 203

## PQC Risk Profile

**Harvest Now, Decrypt Later:** **HIGH** — Encrypted data captured today can be decrypted by a future quantum computer (harvest-now-decrypt-later attack). Adopting this specification is critical to protect long-lived confidential data.

**Identity & Authentication Integrity:** **HIGH** — A quantum-capable adversary could forge certificates or impersonate identities protected by classical public-key cryptography. Migration to PQC-safe PKI and authentication systems is essential.

**Digital Signature Integrity:** Not directly addressed by this document.

**Migration urgency:** High

## PQC Key Types & Mechanisms

| Field                  | Value                  |
| ---------------------- | ---------------------- |
| Algorithm family       | Lattice-based          |
| Security levels        | L1,L3,L5               |
| Protocol / tool impact | CMS encryption, S/MIME |
| Toolchain support      | OpenSSL CMS            |

## Short Description

Defines CMS KEMRecipientInfo structure for PQ KEMs including ML-KEM.

## Long Description

RFC 9629 CMS KEMRecipientInfo August 2024 Housley, et al. Standards Track [Page] Stream: Internet Engineering Task Force (IETF) RFC: 9629 Updates: 5652 Category: Standards Track Published: August 2024 ISSN: 2070-1721 Authors: R. Housley Vigil Security J. Gray Entrust 大久保 智史 ( T. Okubo ) Penguin Securities Pte. Ltd. RFC 9629 Using Key Encapsulation Mechanism (KEM) Algorithms in the Cryptographic Message Syntax (CMS) Abstract The Cryptographic Message Syntax (CMS) supports key transport and key agreement algorithms. In recent years, cryptographers have been specifying Key Encapsulation Mechanism (KEM) algorithms, including quantum-secure KEM algorithms. This document defines conventions for the use of KEM algorithms by the originator and recipients to encrypt and decrypt CMS content. This document updates RFC 5652. ¶ Status of This Memo This is an Internet Standards Track document. ¶ This document is a product of the Internet Engineering Task Force (IETF). It represents the consensus of the IETF community. It has received public review and has been approved for publication by the Internet Engineering Steering Group (IESG). Further information on Internet Standards is available in Section 2 of RFC 7841. ¶ Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at https://www.rfc-editor.org/info/rfc9629 . ¶ Copyright Notice Copyright (c) 2024 IETF Trust and the persons identified as the document authors. All rights reserved. ¶ This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents ( https://trustee.ietf.org/license-info ) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Revised BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Revised BSD License. ¶ ▲ Table of Contents 1 . Introduction 1.1 . Terminology 1.2 . ASN.1 1.3 . CMS Version Numbers 2 . KEM Processing Overview 3 . KEM Recipient Information 4 . KEM Algorithm Identifier 5 . Key Derivation 6 . ASN.1 Modules 6.1 . KEMAlgorithmInformation-2023 ASN.1 Module 6.2 . CMS-KEMRecipientInfo-2023 ASN.1 Module 7 . Security Considerations 8 . IANA Considerations 9 . References 9.1 . Normative References 9.2 . Informative References Acknowledgements Authors' Addresses 1. Introduction This document updates " Cryptographic Message Syntax (CMS) " [ RFC5652 ] . ¶ The CMS enveloped-data content type [ RFC5652 ] and the CMS authenticated-enveloped-data content type [ RFC5083 ] support both key transport and key agreement algorithms to establish the key used to encrypt and decrypt the content. In recent years, cryptographers have been specifying Key Encapsulation Mechanism (KEM) algorithms, including quantum-secure KEM algorithms. This document defines conventions for the use of KEM algorithms for the CMS enveloped-data content type and the CMS authenticated-enveloped-data content type. ¶ A KEM algorithm is a one-pass (store-and-forward) mechanism for transporting random keying material to a recipient using the recipient's public key. This means that the originator and the recipients do not need to be online at the same time. The recipient's private key is needed to recover the random keying material, which is then treated as a pairwise shared secret (ss) between the originator and recipient. ¶ The KEMRecipientInfo structure defined in this document uses the pairwise shared secret as an input to a key derivation function (KDF) to produce a pairwise key-encryption key (KEK). Then, the pairwise KEK is used to encrypt a content-encryption key (CEK) or a content-authenticated-encryption key (CAEK) for that recipient. All of the recipients receive the same CEK or CAEK. ¶ In this environment,

---

_RFC 9629 CMS KEMRecipientInfo August 2024 Housley, et al. Standards Track [Page] Stream: Internet Engineering Task Force (IETF) RFC: 9629 Updates: 5652 Category: Standards Track Published: August 2024 ISSN: 2070-1721 Authors: R. Housley Vigil Security J. Gray Entrust 大久保 智史 ( T. Okubo ) Penguin Securities Pte. Ltd. RFC 9629 Using Key Encapsulation Mechanism (KEM) Algorithms in the Cryptographic Message Syntax (CMS) Abstract The Cryptographic Message Syntax (CMS) supports key transport and key agreement algorithms. In recent years, cryptographers have_
